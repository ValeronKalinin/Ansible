---
- hosts: all
  remote_user: ansible
  become: yes 
  gather_facts: no
  tasks:
  #обновляем систему и устанавливаем утилиты
  - block: # Для CENTOS
      - name: Upgrade System and install utils
        yum:
          name: 
            - "*" 
            - mc
            - wget
            - net-tools
            - nano
          state: latest 
    #     use_backend: yum4
        
      - name: Install DOCKER
        get_url:
          url: https://download.docker.com/linux/centos/docker-ce.repo
          dest: /etc/yum.repos.d/docker-ce.repo
        yum:
          name: 
            - yum-utils
            - device-mapper-persistent-data
            - lvm2
            - docker-ce 
            - docker-ce-cli 
            - containerd.io
          state: latest
    when: ansible_os_family == "RedHat"


  - name: Start Docker service
    service:
      name: docker
      state: started
      enabled: yes  
  
  - name: Testing
    command: docker run hello-world
    register: output

  - debug:
      var:  output
